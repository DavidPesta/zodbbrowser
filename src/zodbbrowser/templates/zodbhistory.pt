<metal:block metal:use-macro="view/@@zodbbrowser_macros/page">
<metal:block fill-slot="content">

<div class="object">
  <div class="heading">
    <h1>
      Latest transactions
    </h1>
  </div>

  <div class="history">
    <div tal:attributes="class python:'tid' in request and 'none' or 'latest'">
      <h4 class="transaction">
        <a class="title" href="@@zodbbrowser_history">Latest</a>
      </h4>
    </div>
    <div class="transaction" tal:repeat="history view/listHistory"
        tal:attributes="class python:history['current']
                                      and 'transaction current' or 'transaction'">
      <h4 class="transaction" tal:attributes="id string:tid${history/utid}">
        <a class="title" tal:attributes="href history/href">
          #<span tal:replace="history/index" />:
          <span tal:content="history/short" />
        </a>
      </h4>
      <div class="diff">
        <h5 class="expander">
          <img tal:attributes="src context/++resource++zodbbrowser/expand.png"
               alt="expand" />&nbsp;<span tal:replace="python: len(history['objects'])" /> objects saved
        </h5>
        <div class="collapsible" style="display: none">
          <ol>
            <li tal:repeat="obj history/objects">
              <a tal:attributes="href obj/url" tal:content="structure obj/repr">(obj)</a>
            </li>
          </ol>
        </div>
      </div>
    </div>
  </div>

</div>

<div class="footer">
  <a tal:attributes="href view/homepage">zodb browser</a>
  v<span tal:replace="view/version" />
  | <a href="@@zodbbrowser_help">help</a>
</div>

<img id="collapseImg" style="display:none" alt=""
     tal:attributes="src context/++resource++zodbbrowser/collapse.png" />
<img id="expandImg" style="display:none" alt=""
     tal:attributes="src context/++resource++zodbbrowser/expand.png" />
</metal:block>
</metal:block>
