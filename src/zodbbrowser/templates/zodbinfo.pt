<metal:block metal:use-macro="view/@@zodbbrowser_macros/page">
<metal:block fill-slot="content">

<tal:block define="object view/obj">
  <div class="object">
    <div class="heading">
      <h1>
        <span tal:content="structure view/getBreadcrumbs"></span><br/>
        <span tal:condition="not:object/current" class="tidInfo">
          <span tal:content="string:at ${view/getObjectTidNice}" />
          <br />
          <span tal:content="string:(last change before or at
                                   ${view/getObjectRequestedTidNice})"/>
        </span>
      </h1>
      <h2><i tal:content="view/getObjectType" /></h2>
    </div>

    <div class="attributes"
         tal:define="attributes object/listAttributes"
         tal:condition="attributes">
      <h3><img tal:attributes="src context/++resource++collapse.png"
               alt="collapse" onclick="expand(this)" /> Attributes</h3>
      <h4>
        <tal:block tal:repeat="attr attributes">
          <strong tal:content="attr/name" />:
          <tal:block replace="structure attr/rendered_value" />
          <br />
        </tal:block>
      </h4>
    </div>

    <div class="history"
         tal:define="history object/listHistory"
         tal:condition="history">
      <h3><img tal:attributes="src context/++resource++collapse.png"
               alt="collapse" onclick="expand(this)" /> History</h3>
      <div>
        <span tal:condition="not:view/getObjectRequestedTid">-&gt;</span>
        <a tal:attributes="href string:zodbinfo.html?oid=${view/getObjectId}">
            Latest</a><br />
        <div class="history" tal:repeat="history history"
            tal:attributes="class python:history['current']
                                            and 'history current' or 'history'">
          <a tal:attributes="href history/href"
            tal:content="string:#${repeat/history/index}"></a>
	      <strong tal:content="history/short" />
	      <br />
	      <tal:block tal:repeat="diff python:history['diff'].iteritems()">
	        <span class="diff">
	          <strong tal:content="python:diff[0]" />: 
	          <span tal:content="python:diff[1][0]" /> 
	          <span tal:content="python:diff[1][1]" />
	        </span> 
	        <br />
	      </tal:block>
        </div>
      </div>
    </div>
  </div>
</tal:block>

</metal:block>
</metal:block>
